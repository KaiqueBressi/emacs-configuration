require 'logger'
require 'json'
require 'concurrent'
require 'httparty'

PROCESS_INSTANCES_TO_MIGRATE = ["2bcf2042-b8b9-4068-8edb-988c1d833775","2f97feea-babb-4290-ab7e-ff7bb025c84a","2bfef2db-d614-4052-825f-e2b421d6876f","6c86672c-b180-4fe1-9c37-eb7e5d9eccdd","2cb6b732-f657-4626-8098-261e20412542","631a8204-41dd-4bab-ac66-8c6f966bc757","7c7fcba2-2176-4de3-ab2f-cce44df26c74","2b44fc27-9745-49bc-b996-b2e1bcbf971f","34418248-63de-4b5d-abe8-b329a57bc9b9","77279841-c8c9-4190-8375-6854218c01e4","019d5743-e8ac-4181-afb7-d3829496736a","8a573783-182e-4863-bc6d-15f1a5a5a2db","3f3ec318-6cbf-4658-8c48-96477d6d59cb","395133f1-497f-4ef5-aa54-63accddcbe82","365298ab-16d9-4a1a-9d08-927887b1d87f","aa168385-08f7-43ca-a7ef-056372d42114","3f6cf7c9-edf1-4950-b246-30fa85bca89f","87448296-c7bb-458b-b0ba-09a4a11dcbde","99f44742-4ab1-42dd-bec4-f18c1b6c2580","ad7b76d8-8dc6-403a-b006-a34631ac78cb","e149cacf-44bb-4de8-853d-1b3bd8ffcd50","830cf606-8307-483e-8eb2-97babeac26ca","d10a59c6-2402-403e-b58c-afe3df50989f","1526ac9a-037c-41bc-9750-659d3d7f3879","78822292-7cd0-45b8-a359-ec9a37bddf4b","c3907599-8663-44b9-8ec4-383227dd8e1f","bf98ca6e-f089-47f1-b1ec-b59ebc24614d","ce0ddf5b-9e48-401d-8ff1-ad8401079588","c02bdf47-b7f7-49e9-8424-d9d32aeb9aeb","2fa87f97-01f2-413f-bf51-6bd100407c8a","d521b58c-baa1-40ee-808c-e73fe78f6c78","848f33c9-0bb1-41bd-bd90-490b12fdaedf","2689a5e6-7a4c-4417-962c-a87753a3016d","e20c5947-d768-496c-bcc0-c8be6b0ab402","ef0a5b8e-15c9-4dce-9524-9f5531bb3db6","8ff4c924-7265-47d4-b19b-584e6968757b","d427c3d6-ebb3-4c7a-abab-610497b7409e","82e4c260-bfc9-44a1-86b9-c28d150a3e65","858e64b9-fec2-4857-ad3e-476e5353b8cd","9c33e430-f6b0-4dd3-8e84-a9055c0ab688","ff397fb3-1a46-4318-9a74-b386dca78e93","570e9533-0b82-446b-bf6d-5b9508acfc35","e2e20ee1-a30c-4c80-8b2a-2c40330eaaad","83a70d58-d8a0-4682-b477-d578d018c67a","d808d636-29af-4c50-95b8-91fb0eb03483","f3b29ad4-ec30-4b13-847f-1303d2bd0088","06e76dbf-fef5-4f6c-8f63-5b944e441585","f29ca41f-a336-4d3c-9427-6ece845e9c83","2b3fc59d-c85d-4eb7-b673-19b5b9eb436f","c9fd6916-34ef-4e2e-b3ce-f113d3590958","e8c35042-0b36-4991-871a-8f21f7a9f124","749dcdaf-3283-4a31-ab55-748eb8439a27","a1e9ff37-b53a-4bf5-a909-471bec728cd8","9ff0d40a-4ad0-499a-a329-9fc0ebd6cae8","86d3ae61-de94-477e-bf26-462135d98864","3d4402d4-980f-4b40-aa34-e11fdd9ab3c6","2a41547e-a2f8-4810-9954-91b970cce778","adc80519-856d-4ad4-8e9f-3bc869c53258","efa95f13-d722-4732-97ca-6a23cf6230f5","1d4084e0-b209-4994-b46b-d3dd8cf45029","139dce8d-4794-4e0a-a472-78c83006f126","4b2fda21-63b2-4677-8522-e2086745ad6d","6ff69ef1-473d-4c3d-9185-e13e26d67e2f","c1edc651-9bd2-478b-a1ae-928fce607714","195f0cba-ce97-45b2-8f9f-780170b69d91","d7880fdf-a470-427a-82f4-fb4a5e4b44f0","31e15578-13d2-4ac5-b311-221b5d5be826","a41e418f-0634-4651-8f40-84cec35bc210","a0cb61da-e6d3-4a28-876f-9207e35aa12f","e33054bc-2102-468c-bff5-109dacbb8fbc","45016c35-e628-479f-b4b7-a2ecb856b85f","e6428fd4-3a27-4805-9ba8-7eb54e1193b4","746e0f42-2046-4995-a3b0-8d78bd2484a1","68ca2f0c-c81d-4853-997d-bb0f898b1aec","dfbd7a25-0e9a-4e8c-9309-812c4c700a4a","a1f7ced3-88a3-4112-8e47-0efacb72bfab","8aca10f6-6e97-4681-9635-1caa27eb5237","1e2d6edc-4d0f-4d01-8bdf-2d1985cab326","075ac606-5cf8-469a-a625-4dafbec9be6e","5f0d9c7f-ece3-45f7-93d3-d1386a2f6843","a5697638-5e7f-4cae-967b-9c4b49b64df5","77c845bd-d1d0-4922-8768-20b8599f492b","8130d219-926b-45d9-bcb4-ff9294124091","19756727-c959-47a4-8917-9830d8efab50","284f337f-b6ae-4e1c-8fd9-464b7d4de574","a60d10e5-811e-4dbf-be2d-db86f72883a7","f2f3b7f1-44e6-49b1-977c-2ffe1f30b851","30a856a0-7310-48ea-9823-e06c9961baa7","517966ec-cb82-43cc-820e-999fb97008f6","00bde85b-1abe-4a77-b4b3-3eb19937eee4","a39dff2a-467c-4fcd-b1f8-4995a62312f8","154df989-5240-41da-aa94-ba774fc3b950","56e18db2-9499-4a1c-af52-83723ab204b9","609f118a-715d-4cd2-ba70-84fbf99039da","b4af077d-1b21-48e8-80e8-110a428e0581","0b94e797-18b9-45cb-be6b-b63bdaf8352c","dfda80ab-e8ab-4473-a84a-e8376dee2193","6d7b9edc-8564-48ff-a8bd-f167f9f21968","3c76fda5-3743-43b0-9c31-0a6866e651e4","add85eef-63b9-4bf3-8b99-acb194348d91","c0ec867c-bacf-4031-8816-0682fa82b673","b8680061-e66b-4c93-a953-8cb8f3a38ab6","c2ed9ced-7421-4992-9501-1f02fae11318","839b8dab-8dfe-48cd-9cee-7935554c8e57","2634ffb7-80ef-4bb6-9a72-976e1cc00e8b","5184108d-a174-4552-97d6-aa766319cfe6","4dd96900-2ea0-49c0-ae58-2e1b99d7c9cf","54830319-a748-4824-bc20-dc5e941aadaa","089fb2c8-140a-4670-9456-3fe93c40a221","94c98de1-115c-451d-a2b5-b232e30eb979","ab314aee-ce4a-4435-b8f5-958df36f013a","691fbfbc-f57f-43b1-a692-5437032b57a9","b7bdc379-4345-4373-8cce-b4b9d3811daa","594207ae-2b17-4205-8eff-7fb9c1f1d05a","dd1b775e-4fc1-4f5e-90d6-7f3c993636dd","6bfe5257-30ba-4911-9d22-14315d2d1ac4","68fbd918-69fa-4110-8ae1-40746e6df520","4e1c202a-f298-4fa7-8c83-4bb01789c085","9cee7fce-7085-4057-8438-a893b4ee751b","192ac3ae-4156-425b-887f-3640b2d28ca6","d0bc642b-e015-48a0-8228-44656cb88368","8bf39520-4a9f-4800-91c5-3a2d59c37847","00ccc30a-c48e-4c4d-bd5b-12db7b0f8c64","458f89f1-5c5d-4465-806b-e4559807e604","9de23980-ce0f-4794-ad48-417ca21d1d09","3d13689a-c1b9-4b50-9b1e-1e8c3315f6dd","f97cc469-51f4-42f1-80b0-fd647b557198","80b8b5cb-8fdc-4456-8dc5-b8fa828bb910","83f7a8f7-ad43-4a8e-809c-d87ab84db97c","db327501-6595-46af-911e-8aeb0b181ec4","268dbb34-9ab8-4b79-9166-3b20faffaf18","97473386-632c-4972-b067-43c7da4a351c","94510c18-b016-4d05-a976-2553bc26a4e6","3eefb07f-b9b2-4bf9-82e0-0f256d881391","7d234f91-b8a9-4db1-af94-227c855a73c3","1d3b6df3-3f2b-4d5b-beb7-4c4dd100f53d","a5025658-6203-468d-b780-72c105138ed9","54be11cf-b720-44ef-bfbf-53f36014ee62","cf8bbf08-b190-49ce-9818-e759c9cf785c","fefe2604-b66b-43ac-bdd4-10676b068770","275e7974-53e1-4e35-a2f7-8bc141fb3c3d","4ec26026-fbad-43ef-a58c-d08566516b52","9c8f84bf-d330-4111-82fd-bcc096a6e0dd","e83a3d92-77e6-4ff1-82fc-1ac4f30b6d3c","f1b3cfff-b813-4021-8c2a-19cdab430e14","532085c5-2f3b-44a1-8a2b-3674332bddcb","ebac262e-1a5e-43da-8bbb-cc0e526cca74","435135fd-7d64-446e-a666-68df5ddef915","835a4f49-21cc-46c2-bacd-bee8165ae503","d03ebcf2-daf2-41f7-b485-ebaa0b0f0f3a","3373bd94-253a-4bd4-b30c-16018604fd4e","5481d8b9-e3d1-4153-9f84-5caf4e80f4bb","e0543bc4-84db-49cd-8921-946f4af1334c","f4ea949a-7a7b-4296-9b56-06c020b3b423","63afbb0d-846d-4aa2-b26f-295999e392bb","484a40a2-54c8-4c98-82be-a0c0bf404750","8f68dda2-c999-44ea-80f1-011e83eb9a2b","2287652e-4160-42bb-af8f-6fb124df109c","2d2dac24-e8df-4fa6-821b-e3141d9df305","5800e090-c2a1-467a-9be4-81fef6cd8b09","e18af826-3320-4024-b302-0914085d7ae5","d7b3a701-0cc0-4606-b406-582eaacd2b98","93832c05-774f-46c7-b4e6-6c94c6d916b1","15e83194-4935-4635-bc0c-46f09b043bf6","fd0022f3-4cf0-4f77-a28a-f5549c26d2c3","fda7c1aa-4ad6-4c78-a349-e24410a41cda","3ef32ef0-ddd2-4fd1-83bd-992616e3d7ba","415f3498-204d-482f-b838-7916c848a7dd","3a31b1cb-9dd0-447b-82ca-e627cce40c92","cb6ff90d-e678-4d6c-9fee-3a7b071bac0d","866319c6-5384-4d62-9f7c-d61563bde354","15442876-4ad7-4aaa-b927-fd1c8a03933d","41240cc5-91a2-4159-9746-de60f2d0f1ce","c684ea41-456b-4f15-ac20-ebd3943e7dea","0ebec927-21c2-4517-8937-d3c1393c3d41","99481a3a-c754-4fe7-90d0-a2fc3b59156f","e106ddcb-07e9-4fec-89f6-d21317f97581","ca6660dd-5d0b-444e-88e9-0a4e1d354447","ec084963-2561-4102-9dda-d0bfb05fa7c3","b0193cb7-b635-4660-bfbd-57d2b4fb4581","ee2f4b4e-de64-4d06-9e3c-a7f9a9469f89","3b12615f-b0ff-4a1e-94b8-9459cfc41464","31373b83-df9a-4ead-9a53-4a530e8a19d8","c266f3cd-1864-4265-b733-32d289adbddc","49567d3c-fa26-42ab-bef8-0c130e20386b","2ca1b93f-8361-4800-9b5f-d69dc8435f62","24179882-9ec7-40b3-8169-1d98000077f6","170128da-0ef5-46bc-9803-f95eab1707d2","d07cab8f-0744-440a-a9da-b0210e21937d","ccfcfb7d-a688-43a5-9879-7c45e2ea8cdd","b2952c62-a404-471e-a5e4-22546b6ae551","b86f6fc3-b48a-406a-b73f-0bfa90993ab3","b5d247d6-3779-4dff-81f2-9305ea0b5f7e","c3c271b8-0f09-4a1f-b067-50b1ce15aeeb","980b7251-fe5d-47dd-a5f9-3c237d897f6a","d25cd6f5-03ed-4eb9-a16f-9e3931cdb841","c9ad9653-d5d1-4d40-a93b-e2114c745e80","109e0c64-c586-4b61-9775-2412d54cc297","3a496abe-f2aa-4a0e-87f2-f2a94e51edb8","856c7aba-a2a9-4a8c-8387-4c65bc3542be","b65d5648-16d8-4423-99fd-1ea8f5d7a808","0d7106d0-0234-4042-b110-1bc83b6a9e36","cc497efa-8ddf-46d4-8d0a-02671fae7d63","c1194566-3ddc-46fe-ace2-0096a621339e","f7939922-b92a-4de5-b83b-b0a0405a4249","404b8db8-b012-4abc-83bf-8bbf24693b35","4b0ba2cc-f4ed-494a-b32a-0ee99223e4b9","5adb40b2-8410-4127-851f-35066e19b598","e9a0fe28-1f93-4900-abe0-f4640b27afa8","7da41929-c31c-481a-baea-782b688f9177","4f194b7a-64b2-4f41-be1a-ad66bd2fe2a1","58a07428-7f63-4d7c-a348-e8d72b2e30d3","4071aa2d-d5dc-4549-8546-8e2a6d536366","1d47df45-d8fe-499f-9eb9-242c48f77a76","2d36e6ba-87c0-45a8-b20d-cb4a8e0f890a","783a386a-d056-4b8b-9efc-cbbdf77a3a9e","acab7ae7-67d4-4311-828b-e8de52603dc3","54d2223a-1856-40fb-8075-6fd1633a1ae6","a0843794-a774-4570-94c9-af4f27004538","f29f028b-fd60-48ef-80a7-74c18217cb59","a09e9415-5d2a-45d2-825e-581ef0798704","6262ca96-2467-4368-a770-a416b01d7121","57eb6bed-8c8b-432a-a31f-1906d23e7c08","eaf4e976-3bdd-4b16-b7e1-828ab0ef5ffb","cb627db7-931f-4046-a990-fdead38e0356","84208447-561f-4c11-9234-b8d1e7180927","5d7aaf58-78b8-49e2-9023-b8ca40590aec","b16c6d71-aa7c-4af8-8985-9671b528d6eb","a062263c-7452-4c8f-abf6-9903021d3f95","42c91e3b-cacd-44e4-ba28-f6f793a04019","1408bca1-d578-4e7a-ac45-f984f478437d","065d9f19-04be-4bf0-975c-dea7bba43d43","f6dd10d3-b8e7-47fe-b4d0-4e6dbf8b8293","f04e362e-f896-44f3-ab78-186bda55e7e1","248aacbf-2223-4227-ab78-b17588bfcb4c","b9e19427-46e6-41da-9764-faf97f4cf663","9732f51f-95e4-42a7-8c70-3917d5fef878","66b2dfaa-ac4a-4a47-82ef-96a2e98892e6","7ce7e6c3-f508-4d6e-b573-0fd62c98391e","382d642e-a3d0-4788-90b3-f4d07b3ec8fc","c709a11a-a53f-4572-a249-614e708ba046","8d8c5162-af66-4080-92da-7b1a50ef889b","46eabffa-66bb-4bd5-ad42-96be58fc785a","9a6a7e70-c2dd-40b4-b9a8-0a877fd8564b","e5cc52eb-b384-4539-bdef-773470ecaec5","0b481ed1-5087-48f9-8ec8-2c38ac636c0c","961a0fc5-fb22-4692-9fe7-fa3ccb4ccaca","8e061e2d-1b92-466e-be3c-a2997dae2bba","15772ce9-82b9-4b28-b2ea-7a152f3f0670","67b7e019-1b09-45b7-b363-2c712b2d7cb5","77655c7f-70bc-4c87-adf1-75a62729f7bc","1fde5084-4609-4421-8010-d838f2f72180","ddb988ed-0e95-4415-b914-77dc8e538c6e","2ab3d02d-cd40-4311-a969-fc0c036b56ca","719e70ae-36f1-40e3-b129-8066b6202bde","0e9658a1-965b-40b9-a4a4-1bd05d24089a","64bcbfe5-7b7e-48e0-b172-31ef30415ee7","eaebfb1e-2711-4cbd-867f-92bdddc24ea7","5ff06f83-b05c-4e86-96e9-930fe83498be","e5cb7a4b-9f9c-4aaf-98ee-b58fc09311cf","773fdc70-69be-4d33-a0c1-443afd72b4f7","423e5ec6-0763-4c69-9ba2-82b67b55bc39","4682652d-d36c-477d-aa96-ee8253bfe5bb","3df8d101-4dfd-4464-9693-84c433e6b22a","24254472-abd8-4414-8a43-b1cdb9ba6f49","f7bc509e-dbad-488c-927d-12bb22a443d9","3d09ad46-c42a-4319-bf0b-079cba153b68","44e9d6cb-0afe-43fe-b79d-fcbdf275fd14","d6a4c00d-dbc3-485b-9568-d63a35f7f4d3","628797af-5d60-4961-b1aa-fa40cd6cc862","5d99cd84-46b3-4950-9f0f-9705a9326fb8","9542f7d1-09fa-4e84-a776-db003c6514fd","88c81280-d76b-45b9-a65b-aa001409c971","67a43ee2-9854-4aa7-a9ce-afbb76406dbb","1f4e6f73-a198-4a1b-b4a4-75310227295d","20dcf37a-2295-45bc-9e60-1d3548f43d79","9d68f0f5-9f64-4852-879c-1a76a25371c5","cbf04d59-0f6e-426d-a9b2-28021e654dc9","fb2ffa64-af3b-4a6e-a71f-2514ec9ddffd","e02dd6e3-af06-433f-aed7-c6a0cc76e692","141da83e-c1a9-4f79-b96a-1ef6daa483ca","9f863e4d-4fa2-4464-bdae-20f07ff37014","c4a04293-5e16-4afe-8788-63e731afe486","a0f7790b-fd1b-413a-b66d-9543ae82c1db","4a94f2ef-cc81-4160-b6a3-43c26183d66f","82667dd8-27ec-498b-b3f2-0795fa7a4d64","c74ddec6-f5dd-43e4-a23b-35f1cebf0946","c6464347-e815-4863-8e33-21dd178dedd1","6ae72027-dca9-40f8-9116-50e5f9f31f63","2be58cb8-b3f4-4c55-bf3b-cad0588c9cc6","dad1054b-6e1a-4751-802b-6b2b2ef4be51","8e9c0fd1-c734-41b8-8697-01358992a680","59b3eac1-16e9-4b94-b6a9-cc29153ac548","78d5b728-19ba-4c02-96dc-d51e584cb368","db551e07-e416-46e0-9a5b-e66060a5c047","bbffb91a-2141-4fe6-9d9c-6ef880b9c2b1","63e21773-3e4a-4677-b481-36a2f76a8904","22d21bdd-fd1e-4d48-a51a-82f1627d7cef","7c494ca0-e418-4ee4-b7fc-917e10a62766","d5fd1289-af19-4339-9e34-679a1017e99b","a447ff33-c340-40d0-b365-cad5142cd6c1","c91c5d1e-fecc-4dd7-9166-a7137dffa505","ecdd6713-b12f-4f44-99e3-d2f162504e77","307cf3d4-9827-4bcf-b01b-8740cb44a39f","bc810b48-e950-4553-8eb0-8d56d036f4ca","5033ad2f-c52d-4caa-a94d-95fb25eb7b2f","5c168d9c-a0d9-46f0-8d4b-90578dfc820c","605f405d-4f91-4084-83f3-1ac95baf4d06","84906148-0c4a-46f5-993b-5f98ee19c68a","a1bf3225-0fa4-4561-ad7a-9b4dc9a03e17","6fe1c4be-3bee-4004-82dc-e26747f67562","806c40d5-cc26-497a-9429-5430caa539a1","9a964202-8a58-4ad3-b1ec-98d1ffb69d4c","12aee9cc-64ba-4505-9e3f-9e7dc86743bd","007f8eba-469a-41a9-86e6-16f17cbe25ca","e6a2a06d-4eaa-418b-b6f2-8d9405468207","8192576d-0e22-4269-b8f1-5a4a1c97475d","d306b876-d00f-43bf-884f-1abc8cb99760","359b6c97-307b-46c5-b9cf-93726b2ed7a5","ecdbfd87-bd1e-448b-8ffc-76badeaf177d","226abb59-4d12-436c-8d50-a3ee6e4db1bc","8239ec5b-c384-458b-b176-7a268afd26f6","8aca19e7-b30e-4916-ad58-95f892a095fc","cf81015a-1be3-4dcc-9f78-8d93d4080e9d","4e970654-35b8-4f7b-89e7-64942420d1f3","0898cf78-08b0-4421-b507-a1c21abb40e1","76c4f9ec-30df-464b-84db-1a4d1f3dbf61","03f43f52-656b-4e0a-950d-ec6f7ed7ba00","20c13634-a679-4374-a73a-3716b22ad03e","afe87945-981c-4c98-a692-b96155ea3612","2574fc99-fd20-4ce3-8bc1-6902491979e6","62a70477-9174-42d5-8b63-9bcbb2308406","eb9a1777-4ac0-4eb1-bb53-557616e9a125","7c586786-3d57-4aa8-9b5c-850d6ceee93e","54a42fce-c665-43fe-8a5a-362dfda536aa","a00e242b-2ef5-48cd-ab8e-9ab6685bc203","b08613d0-7ad1-417a-a560-48ad95805db6","7d43af16-2b84-49b8-9a72-f5311d7cfb03","741db57c-694e-444c-a4e5-01e2be49e559","b28053c5-8ac6-4da7-b90e-b62497c1c7de","69a4da3a-9820-42aa-b2a9-02b346bb45e7","343211d1-bada-4431-b173-bfd68a5b4e1b","4ddc26c7-8406-48c8-b775-3eb0df342809","abf563fb-e118-4685-831b-53fdf690f549","a04385a8-f008-48fa-a009-4ac8b861c9f2","cd3c89c2-7a42-4947-a231-7e0d583dec59","26946919-683f-4dbd-bcd7-34e1da101b8b","77a1a13a-2e3e-493f-bd48-dc44fdd2e6c7","95dbb035-42fc-4d0a-a731-70a84a2c6379","d5f9377d-dcce-4433-8493-afbfdfd98f94","f51bcf77-9563-4ec3-b850-8b2cc6c955dd","1452ba4f-ec9c-4d44-8b50-e72ebe1dfaed","10ac2891-eced-4977-b77d-3630ca55fe03","1edf4c13-e2ff-4d94-a96e-db95ef66a5a4","211edffc-d6ee-4fd5-a095-dc94c693b5b8","4e03f407-2ac4-4af3-b1a7-ddfec67a2691","9d37c158-28a1-443b-8b20-87fa5a6ac8ad","9e859021-cba3-4efa-beb2-1c7164485392","f5fe5570-b8c9-4d93-bf80-eb3114c13c00","1f3d01bf-f80e-4a28-b8d1-6933063241fd","8e9a84a1-0231-49e3-971a-c59b6325be6c","c07a957c-f8ff-444b-9df6-1d121e40c1b7","ef424f95-f904-45e4-a464-3b5c975de731","e17f2014-9de1-4a74-9abf-8f8f63fb04a8","9938bdf9-3562-4a95-ac5e-d2579ab98c3f","7133cec1-1a8e-46d6-9ee1-db9915fdbb73","f09b8864-214d-43e6-ba7a-9d4545e13b9a","2c41f84d-4abd-4cc4-97fb-cab3ef70aaa5","9aee8c96-82e4-42a3-83a3-69f5a1e746b6","3a8ad562-9b04-4aff-b9d8-8b7564d6f8e1","17786266-ba96-4868-a49b-77ec248efdec","2d6059dc-ebff-4c14-8739-4c292a36247f","10453742-17fc-442f-8ca0-b793253e4513","9af17d66-1f3c-40cf-a3b9-e9bce2f52f8a","6175e100-578c-4993-a54f-b333af776e81","582c2e70-e473-4de4-87ae-faa202e5d312","e9a6767f-08cf-424f-983c-fe7f6734b511","4baef183-0cf4-4486-bc5b-987719caf59d","78d4cf13-8f12-40c5-87e0-9b628c3cb79c","093cc919-3e7a-4a9f-b595-1989a14d91ff","c4d46e6b-8672-4a76-b82c-908063dc84f5","0a56c605-36cd-4f8f-9d34-2428817a0f38","547db8e9-75e4-44c7-9824-0bf5ff0c7758","29064902-24b4-4e3e-a85d-4e3b68e48592","85489bf8-b2ac-43b6-af8f-6404d4fbb8bf","cee807c6-e7df-42ae-a75e-ad5e4e6b9975","ee70a4ef-ce2c-46c3-a464-6a51fd196fda","7a72e7bf-4058-4755-855e-819b9e5af6e8","e556dae7-9ed2-40a4-921c-6c559f9d514c","96b063e1-7702-49a5-863e-bc7c31968451","01d3df1d-8f7d-4305-81b3-b7d69a1661d3","e7a6d856-6da4-4225-a129-458541d2d62d","33b05db8-b960-4b3a-ae47-bc94d970f504","52c4782d-3909-4057-a3fc-aaa8bbc5d052","98e12a23-c2ae-43a1-90e4-ced87d6d7ffa","5310aac9-9660-4e7e-91c6-300191552e21","512e44db-d89d-406a-adaf-7f465ebc86bd","6f98b0d9-ae38-42d0-9e2a-dcc7c5c87609","9990b539-f0d9-4fba-bece-e9e9e6a8b34d","01ca74fc-a950-49ad-9270-dee7b6b736a7","67415534-c79c-4088-bfe6-54648eeff11a","2fcf2953-b69b-444a-820c-944c1efedfdf","9044bc46-787d-492b-bdb9-b44e33599260","1f0ccc1c-de85-495f-9bae-0307e441bdb1","2fc0cb80-d613-4ca2-9d76-7d95d9933378","66bfe696-8f68-4616-9715-764898ff1836","c9dc7fc2-8ce0-4220-b87f-b4cc439c7fe2","45cb4af0-e15f-417e-9fbc-e67d868f5b03","7e93ae2d-e56a-4e6d-ab38-212cb20b43cf","04599d14-1243-4d9a-b43c-2a6265c829f4","fa34952a-b369-469d-877b-ca293f692be9","d235b095-2ca5-4db6-a5fc-0bf7a84932f9","b95aaf74-7adf-4d7e-9aaa-0f9d46c8b816","ecf489d0-1f63-4ab1-a6ef-0cb69ea19154","afb56ea7-0970-4d97-bc26-820fb0c40c79","341cb337-21b1-4eff-b97c-91ab9259208a","b9faab94-09a5-4fae-9f8c-3c4fd594351c","2f4fc5e1-14b4-4624-9068-105cb2573a1a","5cf79903-ef76-4a45-9994-42cf4e2a4f01","b7f3df2a-c326-47ea-8fd7-f34de2458c8f","e79b7b36-9801-48f9-9548-d57bda58f082","6b820a60-6efd-418f-beb6-9a5afc1636b4","6949487b-3349-4589-8e5b-36bd14a40df0","af250df4-71ad-4932-9660-2e043a66f28e","359b3c41-9c94-4c2f-bf59-c03b37ef3d87","4763800a-9358-4d25-9fcb-201f6e804f24","aa7bcb63-ea66-4121-a870-c682594fe64a","4f8fccc6-3208-4ae5-9bc9-c55a0c1568f8","e04fbcae-da2a-41f7-a501-e36742f4ab66","368dbf4c-ccad-43c3-ad91-50df1ea85d7d","3ea25c4c-70f6-428b-896b-088237efb5a5","dab6c2ff-589d-4c39-8a11-25e01b3dc0f5","01ecfb78-9a50-4512-b030-e8ff0386b23f","30008ffd-dd55-4650-8f6f-f98d15093aec","2569ecaf-129a-4819-af69-1c79e2475391","6f147461-9be1-4de6-b223-4ba2070b67f6","7b0721c4-cb82-45bc-a124-f7a9d887f654","11324e7f-85c4-4075-b3bb-bce4d619c467","62b3b0e6-3219-4083-9b2b-b31c830d6684","c7cca2c9-6483-4225-b689-65298a47d050","1805c951-1937-4910-bde4-bb58ea98527b","d7c58e83-86ba-4675-be51-037c7e7a1414","4c58fdb6-a5eb-44e6-8409-6efb28fd21b4","cf600a19-039b-4535-b395-f1a1a794b22a","53bfeb27-f26c-4036-a0d9-ea90410b63c1","d99c67c7-7820-4f0c-b73e-d0e9178336cf","2afa5a8c-e68a-42db-ab02-68fb3d113620","aef30fbc-27b5-4b04-8c98-417feff4a0f3","f897ce83-339e-4c3f-8ce7-93181db11d98","7f293112-7353-4199-abe8-07188956e8dd","f2a42f0e-53f9-4d19-8e28-d6b32d326048","dbd60b85-a498-4406-8284-f0625e3743c6","41b1e6f1-720b-4dcd-a616-d38ddcbeae64","7947be75-4680-48d5-94d6-9ec443572351","4dc17a29-5467-4e69-a04e-e78d3f9a7e05","e1688796-c37d-4c20-9a4d-87cf44bd0829","601883cd-16d6-42ac-8b02-9222bff0c6a2","eff7cec5-860e-44a6-aaee-dc49a1cb8eb8","2654f90f-c048-45f9-85a0-347ef5cbabd6","1e9abca0-1bd0-4af7-898b-0319a8232e95","509bea2b-16a6-424c-93a2-5937b9511293","0cdef852-0ff6-4d11-892f-6669d5f761b2","b7588a09-a9f0-4ed4-9dc0-9fbb899c80d1","64fd56de-1073-493b-a486-d0c8278b55e2","35f49dee-72ba-4b02-b0ec-6b732670b432","601ca62d-0942-4e9d-9848-c37a9505cbe5","937bcc3d-6de9-45db-a26b-a0be4a85a362","22938c66-83eb-4a7d-aeaf-e015f8761fbd","7566e631-f40d-4420-97d1-98ce0224c2df","4d36ab94-8db6-471b-b7dc-a4c9132457a7","64cb1ca1-c60f-4144-bfc7-4cd838173e4c","4d96843b-180d-4215-91e5-a7fa84f8c608","8bc73b2f-2cf4-431c-a759-a65ba1049715","b36f60c4-9a4b-4efa-a996-fe851a169194","59fe98e0-ff45-48c2-a153-6cde3bb41364","7653f7a5-ff38-473f-a0ac-cd3ca840a2a9","f15b3bcf-79c4-497b-b017-7620a68b83dc","d4519364-de57-4df8-ad9f-b6b209cd0ecf","052ba51c-77f7-4ea1-ba75-a816feae5c83","4e8c67a9-cced-4208-92e2-a101c53a31e2","9c077e07-097a-46c8-bc89-1e75664c200b","bf32797f-97a0-45d5-916e-05df0a0cf0d3","73b441af-159d-40ca-b588-799de521868f","72762d22-efaa-4b91-b3f9-106cfedc7fe8","17a3e983-9ab4-4073-ad48-c3e7eb332204","b018f83c-b0c0-4e2a-9684-d1c7555b14be","379ab809-2c62-4495-a4ad-cdc9de659d35","40080d3d-4b1f-4b5d-9c82-a3167c2b3e78","4d30e5ff-2b66-46fa-8210-c96edccf7dca","12b0743e-c784-40be-ba12-08a203580e01","847db340-1ae4-4b16-91ef-1a962cc4f387","155f2fe3-4003-485d-9fe8-9636a6985d93","bf3c7ebd-ace4-4249-ab71-ced1610639e7","1359f56c-3c56-4e5a-8900-727e11fd3acd","2b700926-48a5-42b7-95b0-bbf2bb61b79e","1e8a706b-2f57-40f7-b87f-8ebe9b6d294e","3720063c-faae-4ddc-b9bc-39ec5eb067f1","5e1052bb-90b4-4d3e-988d-0d1d6d008675","ce5ea530-f78a-4d95-bade-6db22382d77a","8cec4c69-37e1-46f2-a7b9-830e92bc767e","4386df4d-2d10-4316-a101-f1593c50704f","bdac90b7-7808-4bca-91fa-34683623fa44","9bcd9a5b-b8b4-4537-9023-0f6448fd66a4","368f5189-83d3-4efc-8c8d-4ecf3d83610e","5bcedf36-4d79-4652-ab62-413b5d4a16e7","f7e34400-d67e-47e7-bbb9-ad2e7be4e979","7f31b50d-1ec3-4334-a41d-8c7046e24963","2830813a-a420-4437-b0cc-5becc6db7374", "8fbd15c1-5d04-469b-bd6b-2d620f703f09"]

class Camunda
  include HTTParty

  logger ::Logger.new($stdout)

  base_uri 'https://api.prod.creditas.io/v0/journey-v2'
  headers 'Authorization' => "Bearer #{ENV.fetch('TOKEN')}", 'Content-Type' => 'application/json'
end

def modification_plan_request_body(process_definition_id, process_instances_ids)
  JSON.dump(
    {
      "processDefinitionId" => process_definition_id,
      "processInstanceIds" => process_instances_ids,
      "instructions" => [
        {
          "type" => "cancel",
          "activityId" => "Processamento",
          "cancelCurrentActiveActivityInstances" => true
        },
        {
          "type" => "startBeforeActivity",
          "activityId" => "EsperarPorDocumentosPPBaixo",
        }
      ]
    }
  )
end

def process_instances_filter
  JSON.dump(
    {
      "processDefinitionKey" => "FluxoHome",
      "processInstanceIds" => PROCESS_INSTANCES_TO_MIGRATE,
      "suspended" => false,
    }
  )
end

process_definitions = Camunda.get("/engine-rest/process-definition?key=FluxoHome")

target_process_definition = process_definitions.sort_by { |process_definition| process_definition['version'] }.last
target_process_definition_id = target_process_definition['id']

puts target_process_definition_id

process_instances_ids = PROCESS_INSTANCES_TO_MIGRATE

modification_plan_body = modification_plan_request_body(target_process_definition_id, process_instances_ids)
puts modification_plan_body

puts "Leads para migrar: " + process_instances_ids.count.to_s
puts "Digite \"yes\" para migrar"

yesorno = gets.chomp
exit unless yesorno == "yes"

modification_plan_response = Camunda.post("/engine-rest/modification/executeAsync", body: modification_plan_request_body(target_process_definition_id, process_instances_ids))
puts modification_plan_response
